<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FEISEDY Vintage Sunglasses - Amazon</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
            color: #0f1111;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
        }
        .product-section {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        .product-image {
            flex: 1;
            max-width: 500px;
        }
        .product-image img {
            width: 100%;
            border: 1px solid #ddd;
        }
        .product-info {
            flex: 1;
        }
        .product-title {
            font-size: 24px;
            line-height: 1.3;
            margin-bottom: 10px;
        }
        .rating {
            color: #007185;
            margin-bottom: 10px;
        }
        .price {
            font-size: 28px;
            color: #b12704;
            margin: 15px 0;
        }
        .deal-badge {
            background: #cc0c39;
            color: white;
            padding: 5px 10px;
            display: inline-block;
            margin-bottom: 10px;
            font-size: 14px;
        }
        .color-options {
            margin: 20px 0;
        }
        .color-btn {
            display: inline-block;
            width: 60px;
            height: 60px;
            border: 2px solid #ddd;
            margin: 5px;
            cursor: pointer;
        }
        .color-btn:hover {
            border-color: #007185;
        }
        
        /* Review Section Styles */
        .review-section {
            margin-top: 40px;
        }
        .review-header {
            font-size: 28px;
            margin-bottom: 20px;
        }
        .review-summary {
            display: flex;
            gap: 40px;
            margin-bottom: 30px;
            padding: 20px;
            background: #f9f9f9;
            border: 1px solid #ddd;
        }
        .rating-breakdown {
            flex: 1;
        }
        .rating-bar {
            display: flex;
            align-items: center;
            margin: 8px 0;
        }
        .rating-bar span {
            width: 60px;
            color: #007185;
        }
        .bar {
            flex: 1;
            height: 20px;
            background: #ddd;
            margin: 0 10px;
            position: relative;
        }
        .bar-fill {
            height: 100%;
            background: #ffa724;
        }
        .customers-say {
            flex: 1;
            padding-left: 20px;
            border-left: 1px solid #ddd;
        }
        .aspect-tag {
            display: inline-block;
            padding: 8px 12px;
            margin: 5px;
            background: #e7f5e8;
            border: 1px solid #3a833a;
            border-radius: 20px;
            font-size: 14px;
        }
        .aspect-negative {
            background: #fee;
            border-color: #c44;
        }
        
        .review-item {
            border-bottom: 1px solid #ddd;
            padding: 20px 0;
            margin-bottom: 20px;
        }
        .review-header-info {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .reviewer-name {
            font-weight: bold;
            margin-right: 15px;
        }
        .review-date {
            color: #565959;
        }
        .review-stars {
            color: #ffa724;
            margin-bottom: 5px;
        }
        .review-title {
            font-weight: bold;
            margin-bottom: 8px;
        }
        .review-text {
            line-height: 1.6;
            margin-bottom: 10px;
        }
        .review-metadata {
            font-size: 12px;
            color: #565959;
            padding: 10px;
            background: #f9f9f9;
            border-left: 3px solid #007185;
            margin-top: 10px;
        }
        .verified-badge {
            color: #c45500;
            font-size: 13px;
            margin-left: 10px;
        }
        .helpful-btn {
            margin-top: 10px;
            padding: 8px 15px;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
        }
        .helpful-btn:hover {
            background: #f7f7f7;
        }
        
        .add-review-btn {
            padding: 10px 20px;
            background: #ffd814;
            border: 1px solid #fcd200;
            cursor: pointer;
            font-size: 14px;
            margin-bottom: 20px;
        }
        .add-review-btn:hover {
            background: #f7ca00;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Product Section -->
        <div class="product-section">
            <div class="product-image">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='500' height='500'%3E%3Crect fill='%23e0e0e0' width='500' height='500'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' fill='%23999' font-size='20'%3EProduct Image%3C/text%3E%3C/svg%3E" alt="FEISEDY Sunglasses">
            </div>
            <div class="product-info">
                <h1 class="product-title">FEISEDY Vintage Square 70s Flat Aviator Sunglasses Women Men Classic Retro Stylish Frame UV400 Sunglasses B2622</h1>
                <div class="rating">
                    ★★★★☆ 4.4 out of 5 (3,169 ratings)
                </div>
                <div class="deal-badge">Limited time deal</div>
                <div class="price">$15.15 <span style="font-size:16px; color:#565959; text-decoration:line-through;">$22.99</span></div>
                <p>2K+ bought in past month</p>
                <div class="color-options">
                    <p><strong>Color:</strong> 005 Transparent Green & Gradient Orange Lens</p>
                    <div>
                        <span class="color-btn" style="background:#333"></span>
                        <span class="color-btn" style="background:#8b4513"></span>
                        <span class="color-btn" style="background:#c19a6b"></span>
                        <span class="color-btn" style="background:#90ee90; border:3px solid #007185"></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Review Section -->
        <div class="review-section">
            <h2 class="review-header">Customer Reviews</h2>
            
            <div class="review-summary">
                <div class="rating-breakdown">
                    <h3>4.4 out of 5</h3>
                    <p>3,169 global ratings</p>
                    <div class="rating-bar">
                        <span>5 star</span>
                        <div class="bar"><div class="bar-fill" style="width:74%"></div></div>
                        <span>74%</span>
                    </div>
                    <div class="rating-bar">
                        <span>4 star</span>
                        <div class="bar"><div class="bar-fill" style="width:11%"></div></div>
                        <span>11%</span>
                    </div>
                    <div class="rating-bar">
                        <span>3 star</span>
                        <div class="bar"><div class="bar-fill" style="width:6%"></div></div>
                        <span>6%</span>
                    </div>
                    <div class="rating-bar">
                        <span>2 star</span>
                        <div class="bar"><div class="bar-fill" style="width:3%"></div></div>
                        <span>3%</span>
                    </div>
                    <div class="rating-bar">
                        <span>1 star</span>
                        <div class="bar"><div class="bar-fill" style="width:6%"></div></div>
                        <span>6%</span>
                    </div>
                </div>
                
                <div class="customers-say">
                    <h3>Customers say</h3>
                    <p style="margin-bottom:15px;">Customers find these sunglasses look exactly like the picture and are well-made, offering good value for money.</p>
                    <div>
                        <span class="aspect-tag">✓ Style</span>
                        <span class="aspect-tag">✓ Quality</span>
                        <span class="aspect-tag">✓ Value for money</span>
                        <span class="aspect-tag">✓ Color</span>
                        <span class="aspect-tag">✓ Comfort</span>
                        <span class="aspect-tag aspect-negative">− Fit</span>
                        <span class="aspect-tag aspect-negative">− Durability</span>
                    </div>
                </div>
            </div>

            <button class="add-review-btn" onclick="showReviewForm()">Write a customer review</button>

            <!-- Review Form (Hidden by default) -->
            <div id="review-form" style="display:none; background:#f9f9f9; padding:20px; border:1px solid #ddd; margin-bottom:20px;">
                <h3>Create a Review</h3>
                <form id="new-review-form">
                    <div style="margin:15px 0;">
                        <label><strong>Rating:</strong></label><br>
                        <select id="rating" required style="padding:8px; margin-top:5px;">
                            <option value="">Select rating</option>
                            <option value="5">5 stars</option>
                            <option value="4">4 stars</option>
                            <option value="3">3 stars</option>
                            <option value="2">2 stars</option>
                            <option value="1">1 star</option>
                        </select>
                    </div>
                    <div style="margin:15px 0;">
                        <label><strong>Review Title:</strong></label><br>
                        <input type="text" id="review-title" required style="width:100%; padding:8px; margin-top:5px;">
                    </div>
                    <div style="margin:15px 0;">
                        <label><strong>Review:</strong></label><br>
                        <textarea id="review-text" required rows="6" style="width:100%; padding:8px; margin-top:5px;"></textarea>
                    </div>
                    <div style="margin:15px 0;">
                        <label><strong>Your Name:</strong></label><br>
                        <input type="text" id="reviewer-name" required style="width:100%; padding:8px; margin-top:5px;">
                    </div>
                    <div style="margin:15px 0;">
                        <label><strong>Color Purchased:</strong></label><br>
                        <select id="color-purchased" required style="padding:8px; margin-top:5px; width:100%;">
                            <option value="">Select color</option>
                            <option value="001 Black Frame & Grey Lens">001 Black Frame & Grey Lens</option>
                            <option value="002 Brown Frame & Brown Lens">002 Brown Frame & Brown Lens</option>
                            <option value="003 Tortoise Frame & Brown Lens">003 Tortoise Frame & Brown Lens</option>
                            <option value="005 Transparent Green & Gradient Orange">005 Transparent Green & Gradient Orange</option>
                        </select>
                    </div>
                    <button type="submit" style="padding:10px 20px; background:#ffd814; border:1px solid #fcd200; cursor:pointer; font-size:14px;">Submit Review</button>
                    <button type="button" onclick="hideReviewForm()" style="padding:10px 20px; background:white; border:1px solid #ddd; cursor:pointer; font-size:14px; margin-left:10px;">Cancel</button>
                </form>
            </div>

            <!-- Individual Reviews -->
            <div class="review-item" data-review-id="1">
                <div class="review-stars">★★★★★</div>
                <div class="review-header-info">
                    <span class="reviewer-name">Sarah M.</span>
                    <span class="review-date">Reviewed in the United States on September 16, 2025</span>
                    <span class="verified-badge">✓ Verified Purchase</span>
                </div>
                <div class="review-title">Expensive Looking At a Fraction of The Price</div>
                <div class="review-text">
                    These sunglasses are fabulous. They look like the more expensive brands at a fraction of the price. They fit me perfectly! They are comfortable and don't slip off. They come in the standard colors but also tons of fun color options. I will definitely be purchasing more colors!
                </div>
                <div class="review-metadata">
                    <strong>ABSA Metadata:</strong> Sentiment: Positive | Aspects: {quality: positive, value: positive, fit: positive, comfort: positive, style: positive} | Color: 001 Black Frame & Grey Lens
                </div>
                <button class="helpful-btn">Helpful</button>
            </div>

            <div class="review-item" data-review-id="2">
                <div class="review-stars">★★★★☆</div>
                <div class="review-header-info">
                    <span class="reviewer-name">Mike T.</span>
                    <span class="review-date">Reviewed in the United States on September 8, 2025</span>
                    <span class="verified-badge">✓ Verified Purchase</span>
                </div>
                <div class="review-title">Great style but a bit wide</div>
                <div class="review-text">
                    Love the retro aviator look and the quality seems solid for the price. The color is exactly as pictured. Only issue is they're a bit too wide for my face - they slide down my nose after a while. Might work better for people with wider faces.
                </div>
                <div class="review-metadata">
                    <strong>ABSA Metadata:</strong> Sentiment: Mixed | Aspects: {style: positive, quality: positive, color: positive, fit: negative} | Color: 002 Brown Frame & Brown Lens
                </div>
                <button class="helpful-btn">Helpful</button>
            </div>

            <div class="review-item" data-review-id="3">
                <div class="review-stars">★★★☆☆</div>
                <div class="review-header-info">
                    <span class="reviewer-name">Jennifer K.</span>
                    <span class="review-date">Reviewed in the United States on August 28, 2025</span>
                    <span class="verified-badge">✓ Verified Purchase</span>
                </div>
                <div class="review-title">Broke after two weeks</div>
                <div class="review-text">
                    These looked amazing when I first got them and I received tons of compliments. Unfortunately, one of the earpieces snapped off after only two weeks of normal use. For the price I expected them to last longer. The style is great but the durability is questionable.
                </div>
                <div class="review-metadata">
                    <strong>ABSA Metadata:</strong> Sentiment: Negative | Aspects: {style: positive, durability: negative, quality: negative} | Color: 005 Transparent Green & Gradient Orange
                </div>
                <button class="helpful-btn">Helpful</button>
            </div>

            <div class="review-item" data-review-id="4">
                <div class="review-stars">★★★★★</div>
                <div class="review-header-info">
                    <span class="reviewer-name">David R.</span>
                    <span class="review-date">Reviewed in the United States on August 15, 2025</span>
                    <span class="verified-badge">✓ Verified Purchase</span>
                </div>
                <div class="review-title">Perfect for my needs</div>
                <div class="review-text">
                    Bought these for daily driving and they're perfect. UV protection works well, comfortable to wear for hours, and they don't feel cheap. The weight is just right - not too heavy, not flimsy. Great value!
                </div>
                <div class="review-metadata">
                    <strong>ABSA Metadata:</strong> Sentiment: Positive | Aspects: {comfort: positive, quality: positive, value: positive, weight: positive} | Color: 001 Black Frame & Grey Lens
                </div>
                <button class="helpful-btn">Helpful</button>
            </div>

            <div class="review-item" data-review-id="5">
                <div class="review-stars">★★☆☆☆</div>
                <div class="review-header-info">
                    <span class="reviewer-name">Lisa P.</span>
                    <span class="review-date">Reviewed in the United States on July 30, 2025</span>
                    <span class="verified-badge">✓ Verified Purchase</span>
                </div>
                <div class="review-title">Color not as shown</div>
                <div class="review-text">
                    The tint on the lenses is much darker than the product photos suggested. They're almost too dark for everyday wear. Also found them uncomfortable after wearing for more than 30 minutes - they press on my temples. Returning these.
                </div>
                <div class="review-metadata">
                    <strong>ABSA Metadata:</strong> Sentiment: Negative | Aspects: {color: negative, comfort: negative, fit: negative} | Color: 003 Tortoise Frame & Brown Lens
                </div>
                <button class="helpful-btn">Helpful</button>
            </div>
        </div>
    </div>

    <script>
        // Store reviews in memory
        let reviewsInMemory = [];

        // Show/hide review form
        function showReviewForm() {
            document.getElementById('review-form').style.display = 'block';
        }

        function hideReviewForm() {
            document.getElementById('review-form').style.display = 'none';
            document.getElementById('new-review-form').reset();
        }

        // Handle new review submission
        document.getElementById('new-review-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Collect form data
            const rating = document.getElementById('rating').value;
            const title = document.getElementById('review-title').value;
            const text = document.getElementById('review-text').value;
            const name = document.getElementById('reviewer-name').value;
            const color = document.getElementById('color-purchased').value;
            
            const reviewData = {
                rating: parseInt(rating),
                title: title,
                text: text,
                reviewer_name: name,
                color: color,
                date: new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }),
                product_id: 'B2622',
                verified_purchase: true
            };

            console.log('New review submitted:', reviewData);

            // Call ML API for ABSA analysis
            try {
                // REPLACE THIS WITH YOUR CLOUDFLARE TUNNEL URL FROM COLAB
                // It will look like: https://xxxx-xx-xx-xx-xx.trycloudflare.com
                const ML_API_ENDPOINT = 'https://turner-oils-fighters-been.trycloudflare.com/analyze';
                
                console.log('Sending review to ABSA API:', reviewData);
                
                const response = await fetch(ML_API_ENDPOINT, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(reviewData)
                });

                const apiResponse = await response.json();
                console.log('ABSA Analysis Results:', apiResponse);
                
                // Extract the actual ABSA data from response
                const absaResults = {
                    sentiment: apiResponse.sentiment,
                    aspects: apiResponse.aspects,
                    raw: apiResponse.raw_analysis
                };

                // Store in memory with ABSA results
                reviewData.absa = absaResults;
                reviewsInMemory.push(reviewData);

                // Display the new review immediately
                displayNewReview(reviewData, absaResults);

                // Hide form and reset
                hideReviewForm();
                alert('Thank you! Your review has been submitted and analyzed.');

            } catch (error) {
                console.error('ML API Error:', error);
                
                // If API fails, still store and display with mock analysis
                const mockAbsa = {
                    sentiment: 'pending',
                    aspects: {},
                    note: 'Analysis pending - API unavailable'
                };
                reviewData.absa = mockAbsa;
                reviewsInMemory.push(reviewData);
                displayNewReview(reviewData, mockAbsa);
                hideReviewForm();
                alert('Review submitted! (Note: Sentiment analysis is pending)');
            }

            // Log all reviews in memory
            console.log('All reviews in memory:', reviewsInMemory);
        });

        // Display new review on the page
        function displayNewReview(reviewData, absaResults) {
            const reviewsContainer = document.querySelector('.review-section');
            const firstReview = document.querySelector('.review-item');
            
            const stars = '★'.repeat(reviewData.rating) + '☆'.repeat(5 - reviewData.rating);
            
            const newReviewHTML = `
                <div class="review-item" data-review-id="new-${Date.now()}" style="background:#fffacd; border:2px solid #ffd814;">
                    <div style="display:inline-block; background:#ffd814; padding:3px 8px; font-size:12px; font-weight:bold; margin-bottom:10px;">NEW REVIEW</div>
                    <div class="review-stars">${stars}</div>
                    <div class="review-header-info">
                        <span class="reviewer-name">${reviewData.reviewer_name}</span>
                        <span class="review-date">Reviewed in the United States on ${reviewData.date}</span>
                        <span class="verified-badge">✓ Verified Purchase</span>
                    </div>
                    <div class="review-title">${reviewData.title}</div>
                    <div class="review-text">${reviewData.text}</div>
                    <div class="review-metadata">
                        <strong>ABSA Metadata:</strong> Sentiment: ${absaResults.sentiment || 'pending'} | 
                        Aspects: ${JSON.stringify(absaResults.aspects || {})} | 
                        Color: ${reviewData.color}
                    </div>
                    <button class="helpful-btn">Helpful</button>
                </div>
            `;
            
            firstReview.insertAdjacentHTML('beforebegin', newReviewHTML);
        }

        // Simple interactivity for helpful buttons
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('helpful-btn')) {
                e.target.textContent = 'Thanks for your feedback!';
                e.target.style.background = '#e7f5e8';
                e.target.disabled = true;
            }
        });

        // Log review data when clicked (for your ABSA model integration)
        document.addEventListener('click', function(e) {
            const reviewItem = e.target.closest('.review-item');
            if (reviewItem) {
                const reviewId = reviewItem.dataset.reviewId;
                const metadataEl = reviewItem.querySelector('.review-metadata');
                if (metadataEl) {
                    console.log('Review clicked:', {id: reviewId, metadata: metadataEl.textContent});
                }
            }
        });

        // Export function to retrieve all reviews in memory
        function getReviewsInMemory() {
            return reviewsInMemory;
        }

        // Make it available globally for your dashboard
        window.getReviewsInMemory = getReviewsInMemory;
    </script>
</body>
</html>
